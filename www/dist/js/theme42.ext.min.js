/*global apex, $v*/
/*!
 theme42.ext.js
 Copyright (c) 2012, 2017 Oracle and/or its affiliates. All rights reserved.
 */
apex.theme42&&!apex.theme42.ext&&(apex.theme42.ext={},function(e,t){"use strict";var a,n,r,i,o,s,c,u,l,h,f,d=$v("pFlowStepId");t.filterItem=function(t){var a=t.pItem,n=t.pSearchItem,r=e("#"+n);r.attr("type","search");var i=new function(t){var n=[],r=apex.item(a).item_type,i=function(e){if("CHECKBOX_GROUP"===r)return e.next().text().toLowerCase()},o=function(e){if("CHECKBOX_GROUP"===r)return e.parent()};e("input[name="+t+"]").each(function(){var t=e(this);n.push({node$:t,txt:i(t)})}),this.search=function(a){var r,i,s;if(a)for(e("#"+t).addClass("js-filter-active"),r=0;r<n.length;r++)i=n[r],s=o(i.node$),i.txt.indexOf(a.toLowerCase())>=0?s.addClass("js-filter-match"):s.removeClass("js-filter-match");else e("#"+t).removeClass("js-filter-active")}}(a);i.search(r.val()),r.on("keydown",function(t){13===t.which?t.preventDefault():27===t.which&&(t.stopPropagation(),e(this).val(""))}).on("keyup",function(t){i.search(e(this).val())})},t.filterReportPage=function(t){var a,n=t.pRegions,r=t.pToggleItem,i=e("#"+r),o=e("#"+t.pSearchItem),s=Object.keys(n),c=function(){var t,a,i,c=$v(r),u=o.val();for(i=0;i<s.length;i++)t=n[s[i]],a=e("#"+t),c===s[i]?(a.show(),a.data("key")!==u&&a.trigger("apexrefresh").data("key",u)):a.hide()};o.on("keydown",function(e){13===e.which&&e.preventDefault()}).on("input",function(){clearTimeout(a),a=setTimeout(c,250)}),i.change(c),c()},t.masterDetailPage={},a=t.masterDetailPage,n="P"+d+"_FILTER_COUNT",r=[],i=e(".js-master-region, .js-detail-rds, .js-detail-region"),o=e(".no-record-selected"),s=e(".t-Body-contentInner"),c=function(){i.hide(),o.show(),s.addClass("center-regions")},u=function(){i.show(),o.hide(),s.removeClass("center-regions")},l=function(t,a){var n=e(".js-master-row");if(n[0]){var r=n.filter('[data-id="'+t+'"]').parent();a&&h(r.find("a.js-master-row")),e(".search-results").animate({scrollTop:r.position().top-e(".search-region").outerHeight()},500),r.addClass("is-active").focus()}},h=function(t){var a=e(".js-master-row").parent(),n=e(t);e.ajax({url:n.data("checksum")}).done(f),a.removeClass("is-active"),n.parent().addClass("is-active")},f=function(){i.trigger("apexrefresh"),e(".js-links-region").trigger("apexrefresh"),u()},a.initializePage=function(t){var a=$v(t);""!==a?e(window).on("theme42ready",function(){l(a),u()}):c(),e("body").on("click",".js-master-row",function(e){h(this)}),e("#links_region .js-button-url").each(function(t){r.push(e(this).data("button-id"))})},a.hideRecord=c,a.showRecord=u,a.scrollToRecord=l,a.refreshReports=f,a.buildButtons=function(){var t,a,n=r.length;for(e("#links_region .js-button-url").each(function(){r.push(e(this).data("button-id"))}),a=0;a<n;a++)t=r[a],e("#"+t).attr("onclick",e('[data-button-id="'+t+'"]').attr("href"))},a.updateFilterBadge=function(){var t,a=$v(n);e("#apply_filters_btn .t-Button-label").append('<span id="filter_count"></span>'),t=e("#filter_count"),a>0?t.text(a):t.text("")}}(apex.jQuery,apex.theme42.ext));